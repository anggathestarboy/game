<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    
    <style>
      body {
        background-color: rgb(47, 47, 47);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100dvh;
        color: white;
        font-family: sans-serif;
      }
      
      canvas, #score, #timer {
        display: none;
      }
      
      #menu {
        background-color: rgb(42, 42, 151);
        border-radius: 20px;
        justify-content: center;
        text-align: center;
        padding: 20px;
       
      }
      
    
    </style>
  </head>
  <body>
    <div id="menu">
    <h1>PHYTON</h1>
    <p>Masukkan nama kamu untuk mulai bermain</p>


    <input type="text" id="playerName" placeholder="Nama pemain" />

    <h3>Instruksi:</h3>
    <ol style="text-align: left;">
        <li>isi nama pemain dan tekan play</li>
        <li>Gunakan tombol WASD untuk menggerakkan ular</li>
        <li>Arahkah ular ke pallet</li>
        <li>Jangan sampai tertabrak</li>
    </ol>
   

    <button onclick="startGame()">Start Game</button>
  </div>
    <p id="score">Score: 6</p>

  <canvas id="myCanvas" height="600" width="960" style="border: 2px solid black"></canvas>
    <p id="timer">00:00:00</p>


    <script>
      let score = 6;   

          function startGame() {
      let nameInput = document.getElementById("playerName").value;

      if (nameInput === "") {
        alert("Silakan isi nama terlebih dahulu!");
        return;
      }

      
      document.getElementById("menu").style.display = "none";
      document.getElementById("score").style.display = "block";

        timerInterval = setInterval(updateTimer, 1000);
      canvas.style.display = "block";
  document.getElementById("timer").style.display = "block";
     
     let loop = null;
    }
      let canvas = document.getElementById("myCanvas");
      let ctx = canvas.getContext("2d");

      let GRID = 20;
      let COLS = 30;
      let ROWS = 48;

     let snake = [
  {x:15, y:10}, // kepala
  {x:14, y:10},
  {x:13, y:10},
  {x:12, y:10},
  {x:11, y:10},
  {x:10, y:10}, // ekor
];


      function drawSnake() {
        ctx.fillStyle = "green";
        snake.map((s) => {
          ctx.fillRect(s.x * GRID, s.y * GRID, GRID, GRID);
        });
      }

      let food = {
        x: Math.floor(Math.random() * ROWS),
        y: Math.floor(Math.random() * COLS),
      };

      function drawFood() {
        ctx.fillStyle = "red";
        ctx.fillRect(food.x * GRID, food.y * GRID, GRID, GRID);
      }

      let arah = {
        x: 1,
        y: 0,
      };
      
      let seconds = 0;
let timerInterval = null;

      
      
      function updateTimer() {
  seconds++;

  let hrs = String(Math.floor(seconds / 3600)).padStart(2, "0");
  let mins = String(Math.floor((seconds % 3600) / 60)).padStart(2, "0");
  let secs = String(seconds % 60).padStart(2, "0");

  document.getElementById("timer").textContent = `${hrs}:${mins}:${secs}`;
}


      function updateSnake() {
        let kepala = {
          x: snake[0].x + arah.x,
          y: snake[0].y + arah.y,
        };

        if (kepala.x >= ROWS) {
          kepala.x = 0;
        }
        if (kepala.x < 0) {
          kepala.x = ROWS - 1;
        }
        if (kepala.y >= COLS) {
          kepala.y = 0;
        }
        if (kepala.y < 0) {
          kepala.y = COLS - 1;
        }

        for (let i = 1; i < snake.length; i++) {
          if (snake[i].x === kepala.x && snake[i].y === kepala.y) {
            alert("GAME OVER: Ular menabrak dirinya sendiri!");
            clearInterval(loop);
            window.location.href = "ular.html"
          }
        }

        let kepala1 = snake.unshift(kepala);

        if (kepala.x === food.x && kepala.y === food.y) {
          food.x = Math.floor(Math.random() * ROWS);
          food.y = Math.floor(Math.random() * COLS);
            score++;
  document.getElementById("score").textContent = "Score: " + score;
        } else {
          snake.pop();
        }
      }

      document.addEventListener("keydown", (e) => {
        if (e.key === "w") {
            
            if (arah.y !== 1) {
                 arah = { x: 0, y: -1 };
            }
         
        } else if 
        
        (e.key === "s") {
             if (arah.y !== -1) {
                arah = { x: 0, y: 1 };
             }
          
        } else if (e.key === "a") {
              if (arah.x !== 1) {
                   arah = { x: -1, y: 0 };
              }
       
        } else if (e.key === "d") {
            if (arah.x !== -1) {
                  arah = { x: 1, y: 0 };
            }
        
        }
      });

      function drawGrid() {
        for (let x = 0; x < ROWS; x++) {
          for (let y = 0; y < COLS; y++) {
            let isDark = (x + y) % 2 === 0;
            ctx.fillStyle = isDark ? "white" : "lightblue";
            ctx.fillRect(x * GRID, y * GRID, GRID, GRID);
          }
        }
      }

      function gameLoop() {
        drawGrid();
        updateSnake();
        drawFood();
        drawSnake();
      }

      let loop = setInterval(gameLoop, 120);
    </script>
  </body>
</html>
